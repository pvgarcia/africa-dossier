<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Cape Town ‚Üí Kruger Safari ‚Üí Victoria Falls | Garcia Gang</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#81572f; --paper:#F2EEE6; --ink:#3E3B34; --ink-soft:#6E6256; --line:#C7BEB0;
    --accent:#7D8B6A; --accent-2:#C6A664; --accent-3:#8DA3A6;
    --brown:#5a3e1b; --brown-dark:#3b2610; --shadow:0 18px 45px rgba(0,0,0,.12);
    --radius:16px; --gap:12px;
    --fs-0: clamp(14px, 3.5vw, 16px);
    --fs-1: clamp(16px, 4.5vw, 18px);
    --fs-2: clamp(18px, 5.5vw, 22px);
    --fs-3: clamp(22px, 7vw, 30px);
    --page-gutter: clamp(14px, 4vw, 22px);
  }
  [data-theme="dark"]{
    --bg:#1f1b16; --paper:#2a251f; --ink:#efe9df; --ink-soft:#c8bcae; --line:#4a4136;
    --accent:#9cc07e; --accent-2:#d8b56a; --accent-3:#88b8bd; --brown:#f7e1c0; --brown-dark:#ffe8c8;
  }

  /* Global */
  *{box-sizing:border-box}
  html, body { min-height:100%; height:auto; overflow-x:hidden; } /* kill horizontal overflow on iPhone */
  body{
    margin:0;
    font-family: Aptos, "Segoe UI Variable", "Segoe UI", system-ui, -apple-system, Roboto, "Helvetica Neue", Arial, sans-serif;
    background:linear-gradient(180deg, var(--bg), #EFEAE2 50%, var(--bg));
    color:var(--ink);
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    font-size: var(--fs-0); line-height:1.45;
  }
  img, table { max-width:100%; }

  /* Content wrapper with equal left/right gutters + safe areas */
  .wrap{
    max-width:1200px; width:100%;
    margin:0 auto;
    padding:1.25rem var(--page-gutter) 3rem;
    display:grid; gap:1rem;
  }
  @supports (padding: max(0px)){
    .wrap{
      padding-left: calc(var(--page-gutter) + env(safe-area-inset-left));
      padding-right: calc(var(--page-gutter) + env(safe-area-inset-right));
    }
  }

  /* HERO */
  .hero{position:relative; height:62vh; min-height:420px; overflow:hidden; border-bottom:1px solid var(--line); margin-bottom:0; z-index:1;}
  .hero::before{ /* full-bleed color behind the image */
    content:""; position:absolute; inset:0;
    left:50%; transform:translateX(-50%); width:100vw; background:var(--bg); z-index:0;
  }
  .slides{position:absolute; inset:0; z-index:1;}
  .slide{position:absolute; inset:0; background-size:cover; background-position:center; opacity:0; transition:opacity .9s}
  .slide.active{opacity:1}
  .slide::after{content:""; position:absolute; inset:0; background:linear-gradient(to bottom, rgba(0,0,0,.18), rgba(0,0,0,.10) 40%, rgba(0,0,0,.20));}
  .slide-caption{
    position:absolute; left:16px; right:16px; bottom:18px; z-index:2;
    background:rgba(255,255,255,.72); color:var(--brown);
    padding:12px 14px; border-radius:12px; border:1px solid rgba(0,0,0,.08);
    box-shadow:0 6px 20px rgba(0,0,0,.12);
    max-width:min(820px, calc(100vw - 32px));
  }
  .slide-caption h2{margin:0 0 6px 0; font-family:'Playfair Display',serif; font-weight:700; font-size:clamp(1rem,.7rem + 1.4vw,1.6rem)}
  .slide-caption a{color:var(--brown-dark); text-decoration:none; font-weight:700; border-bottom:1px dashed rgba(58,38,16,.35)}

  /* Dots */
  .carousel-controls{
    position:absolute; left:50%; bottom:8px; transform:translateX(-50%);
    display:flex; gap:.45rem; z-index:3; max-width:100vw; overflow:hidden;
  }
  .dot{width:9px; height:9px; border-radius:50%; background:rgba(255,255,255,.55); border:1px solid rgba(0,0,0,.15); cursor:pointer}
  .dot.active{background:rgba(255,255,255,.95)}

  /* NAV */
  .nav{position:sticky; top:0; z-index:1000; backdrop-filter:saturate(140%) blur(6px); border-bottom:none;}
  .nav::before{
    content:""; position:absolute; inset:0; left:50%; transform:translateX(-50%);
    width:100vw; background:rgba(242,238,230,.86); border-bottom:1px solid var(--line); z-index:-1;
  }
  .nav-inner{max-width:1200px; margin:0 auto; display:flex; gap:.6rem; align-items:center; padding:.6rem 1rem; overflow:auto}
  .nav a{color:var(--ink-soft); text-decoration:none; padding:.4rem .65rem; border-radius:10px; border:1px solid transparent; white-space:nowrap}
  .nav a.active, .nav a:hover{border-color:var(--line); color:var(--ink)}
  .nav .spacer{flex:1}
  .btn{font-family:inherit; font-weight:600; border:1px solid var(--line); background:var(--paper); padding:.5rem .7rem; border-radius:12px; cursor:pointer}

  /* Cards, tables, utilities */
  .card{background:var(--paper); border:1px solid var(--line); border-radius:18px; box-shadow:var(--shadow); padding:clamp(1rem,1.6vw,1.4rem)}
  h1,h2{font-family:'Playfair Display',serif}
  .section-title{margin:.2rem 0 1rem}
  .muted{color:var(--ink-soft)}
  table{border-collapse:collapse; width:100%} th,td{border:1px solid var(--line); padding:.65rem .6rem; text-align:left} th{background:#EEE7DC}
  [data-theme="dark"] th{background:#3a332b}
  .pill{display:inline-block; padding:.28rem .6rem; border:1px solid var(--line); border-radius:999px; background:#fbf9f5; color:var(--ink-soft); font-size:.9rem}
  .soft-card{background:#fbf9f5; border:1px solid var(--line); border-radius:14px; padding:1rem}
  [data-theme="dark"] .soft-card{background:#221e18}
  .mini{margin:.2rem 0 0} .mini li{margin:.25rem 0}

  /* Pair grid */
  .pair-grid{ display:grid; grid-template-columns: 1.2fr .8fr; gap: 1rem; }
  .pair-grid .cell{ display:flex; align-items:stretch; }
  .pair-grid .soft-card{ width:100%; display:flex; flex-direction:column; }

  /* Scroll animations */
  .reveal{ opacity:0; transform:translateY(16px); transition:opacity .7s ease, transform .7s ease; }
  .reveal.show{ opacity:1; transform:none; }
  [data-anim="fade-left"]  { transform:translateX(18px); }
  [data-anim="fade-right"] { transform:translateX(-18px); }
  [data-anim="zoom-in"]    { transform:scale(.96); }
  .reveal{ transition-delay: var(--d, 0s); }

  /* Countdown */
  .countdown{
    display:grid;
    grid-template-columns: repeat(4, minmax(90px,1fr));
    gap:clamp(10px,2vw,16px);
    align-items:stretch;
    width:100%;
  }
  .cd-card{
    background:linear-gradient(#fff, var(--paper));
    border:1px solid var(--line);
    border-radius:14px;
    box-shadow:0 6px 20px rgba(0,0,0,.08);
    padding:12px 10px;
    text-align:center;
  }
  .cd-val{
    font-weight:800; font-size:clamp(26px,8vw,48px); line-height:1;
    font-variant-numeric: tabular-nums lining-nums;
    font-feature-settings:"tnum" 1,"lnum" 1;
    letter-spacing:.02em;
  }
  .cd-label{display:block; margin-top:6px; color:var(--ink-soft); font-weight:700}
  .cd-bump{animation:cd-bump .22s ease both}
  @keyframes cd-bump{0%{transform:translateY(-6px);opacity:.35}100%{transform:none;opacity:1}}

  /* Widgets */
  .widgets{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap:1rem;
  }
  .w{min-width:0}
  .w.wide{grid-column: 1 / -1}

  .widget-head{display:flex; align-items:center; justify-content:space-between; gap:.6rem; margin-bottom:.6rem; flex-wrap:wrap}
  .widget-head h3{margin:0; font-family:'Playfair Display',serif}

  .input, select, textarea{width:100%; padding:.6rem .7rem; border:1px solid var(--line); border-radius:12px; background:var(--paper); color:var(--ink); font-size:16px}
  .row{display:flex; gap:.6rem; align-items:center; flex-wrap:wrap}
  .row > *{flex:1 1 160px}
  .list{display:grid; gap:.6rem}
  .chip{display:inline-flex; align-items:center; gap:.4rem; padding:.3rem .6rem; border:1px solid var(--line); border-radius:999px; background:#fff7ec}
  [data-theme="dark"] .chip{background:#2c251e}
  .progress{height:10px; background:#e7dfd3; border-radius:999px; overflow:hidden}
  .progress > span{display:block; height:100%; background:linear-gradient(90deg,var(--accent),var(--accent-2)); width:0}

  .checklist{display:grid; gap:.5rem}
  .check{display:flex; align-items:center; gap:.6rem}
  .check input[type="checkbox"]{width:18px; height:18px}

  .gallery{display:grid; grid-template-columns:repeat(6,1fr); gap:.5rem}
  .gallery img{width:100%; height:120px; object-fit:cover; border-radius:10px; cursor:pointer; border:1px solid var(--line)}
  .lightbox{position:fixed; inset:0; background:rgba(0,0,0,.7); display:none; align-items:center; justify-content:center; z-index:999}
  .lightbox.show{display:flex}
  .lightbox img{max-width:90vw; max-height:80vh; border-radius:12px; box-shadow:var(--shadow)}

  .table-wrap{overflow:auto; -webkit-overflow-scrolling:touch}
  .table-wrap table{min-width:520px}

  /* Health visa row */
  #health .visa-row{
    grid-column: 1 / -1;
    display: grid;
    grid-template-columns: repeat(2, minmax(0,1fr));
    gap: 1rem;
    align-items: stretch;
    margin-top: 1rem;
  }
  #health .visa-row .soft-card{display:flex; flex-direction:column; height:100%;}

  /* Print */
  @media print{
    .hero,.nav,.to-top,.carousel-controls,.btn,.lightbox{display:none !important}
    .wrap{padding:0}
    .card{box-shadow:none; border:1px solid #ddd}
  }

  /* Responsive */
  @media (max-width: 900px){
    .pair-grid{ grid-template-columns: 1fr; }
  }
  @media (max-width: 640px){
    .hero{height:56vh; min-height:360px}
    .countdown{grid-template-columns: repeat(2, 1fr);}
    .gallery{grid-template-columns:repeat(3,1fr)}
    #health .visa-row{ grid-template-columns: 1fr; }
  }

  /* === Center everything and stop right-edge clipping === */

/* You can tweak this to taste */
:root { --content-max: 940px; }

/* Make the main column a centered container */
.wrap{
  /* keep your existing padding vars */
  max-width: none;            /* let the children clamp themselves */
  display: grid;
  gap: 1rem;
  justify-items: center;      /* center children horizontally */
  padding-inline: var(--page-gutter);
}

/* Every direct child (your big cards/sections) centers and clamps */
.wrap > *{
  width: min(100%, var(--content-max));
  margin-inline: auto;        /* belt-and-suspenders centering */
  box-sizing: border-box;
}

/* Match the nav inner width to the same column */
.nav-inner{ max-width: var(--content-max); }

/* Safety: prevent flex/grid children from forcing overflow */
.card, .soft-card, .row, .widgets, .pair-grid, .table-wrap{ min-width: 0; }
.row > *{ min-width: 0; }            /* inputs/selects won‚Äôt push wider than the card */
img, video{ height:auto; display:block; }

/* Tables stay inside the card on phones */
.table-wrap{ max-width:100%; overflow:auto; -webkit-overflow-scrolling: touch; }
.table-wrap table{ min-width:520px; } /* you already had this‚Äîkept for clarity */

/* Kill any phantom horizontal scroll (especially on iOS) */
html, body{ overflow-x:hidden; }

/* iPhone safe areas on BOTH sides (works with Dynamic Island) */
@supports (padding: max(0px)) {
  .wrap{
    padding-left:  calc(var(--page-gutter) + env(safe-area-inset-left));
    padding-right: calc(var(--page-gutter) + env(safe-area-inset-right));
  }
  .nav-inner{
    padding-left:  max(.6rem, env(safe-area-inset-left));
    padding-right: max(.6rem, env(safe-area-inset-right));
  }
}
/* Fix Task Board input row overflow */
#tasksCard .row {
  flex-wrap: wrap;       /* allow wrapping */
  gap: 0.5rem;           /* spacing between items */
}

#tasksCard .row input,
#tasksCard .row button {
  flex: 1 1 auto;        /* allow shrinking and wrapping */
  min-width: 100px;      /* prevent collapsing too small */
}

#tasksCard .row button {
  flex: 0 0 auto;        /* buttons keep their natural size */
}
/* Task Board input row styling */
#tasksCard .row.add-task {
  display: flex;
  flex-direction: column; /* stack input above buttons */
  align-items: stretch;
  gap: 0.5rem;
}

/* Full-width input like other tasks */
#tasksCard .row.add-task .input {
  width: 100%;
  flex: none;
}

/* Keep buttons aligned and contained */
#tasksCard .row.add-task .btn {
  flex: 0 0 auto;
  align-self: flex-start; /* buttons hug the left */
}

</style>
</head>

<body>

<!-- ===== HERO with slides (carousel) ===== -->
<header class="hero" aria-label="Destination banners">
  <div class="slides" aria-hidden="true">
    <div class="slide active" style="background-image:url('images/cape-town-africa.jpg')">
      <div class="slide-caption reveal" data-anim="zoom-in" style="--d:.1s">
        <h2>Cape Town ‚Äî Table Mountain</h2>
        <a href="#family-hub">Plan with the Garcia Gang</a>
      </div>
    </div>
    <div class="slide" style="background-image:url('images/kruger-big5.jpg')">
      <div class="slide-caption reveal" data-anim="zoom-in" style="--d:.1s">
        <h2>Kruger National Park ‚Äî Big Five</h2>
        <a href="#highlights">Explore Highlights</a>
      </div>
    </div>
    <div class="slide" style="background-image:url('images/victoria-falls.jpg')">
      <div class="slide-caption reveal" data-anim="zoom-in" style="--d:.1s">
        <h2>Victoria Falls ‚Äî The Smoke That Thunders</h2>
        <a href="#family-hub">RSVP & Checklist</a>
      </div>
    </div>
  </div>
  <div class="carousel-controls" role="tablist" aria-label="Hero destination slides">
    <button class="dot active" role="tab" aria-selected="true" aria-label="Cape Town"></button>
    <button class="dot" role="tab" aria-selected="false" aria-label="Kruger"></button>
    <button class="dot" role="tab" aria-selected="false" aria-label="Victoria Falls"></button>
  </div>
</header>

<!-- ===== Sticky nav ===== -->
<nav class="nav" aria-label="Section navigation">
  <div class="nav-inner">
    <a href="#glance">At a Glance</a>
    <a href="#flights">Flights & Costs</a>
    <a href="#highlights">Highlights</a>
    <a href="#family-hub">Family Hub</a>
    <a href="#packing">Packing</a>
    <a href="#budget">Budget</a>
    <a href="#health">Health & Visas</a>
    <a href="#gallery">Gallery</a>
    <span class="spacer"></span>
    <button id="themeToggle" class="btn" aria-pressed="false" title="Toggle theme">üåì Theme</button>
    <button id="printBtn" class="btn" title="Print / Save PDF">üñ®Ô∏è Print</button>
    <button id="shareBtn" class="btn" title="Share">üîó Share</button>
  </div>
</nav>

<main class="wrap">
  <!-- === AT A GLANCE === -->
  <section id="glance" class="card reveal" data-anim="fade-right" style="--d:.05s" aria-labelledby="glance-title">
    <h2 id="glance-title" class="section-title">At a Glance</h2>
    <p class="muted"><span class="pill reveal" data-anim="zoom-in" style="--d:.12s">9 nights</span> <span class="pill reveal" data-anim="zoom-in" style="--d:.18s">Family Fun</span> <span class="pill reveal" data-anim="zoom-in" style="--d:.24s">Garcia Gang</span></p>
    <div class="row" style="margin:.6rem 0 1rem">
      <div class="muted" style="flex:0 0 auto; min-width:170px">Trip start date</div>
      <div class="pill" style="flex:0 0 auto; padding:.6rem 1rem; font-weight:600">June 1, 2027</div>
    </div>
    <div id="countdown" class="countdown" aria-live="polite" data-start="2027-06-01T00:00:00-06:00"></div>
    <div class="table-wrap reveal" data-anim="fade-right" style="--d:.12s; margin-top:1rem">
      <table>
        <thead><tr><th>Days</th><th>Where</th><th>Key Notes</th></tr></thead>
        <tbody>
          <tr><td>1‚Äì3</td><td><a class="maplink" target="_blank" rel="noopener noreferrer" href="https://www.google.com/maps/place/Cape+Town,+South+Africa">Cape Town</a></td><td>Table Mountain, Robben Island, Cape of Good Hope, Penguins</td></tr>
          <tr><td>4‚Äì6</td><td><a class="maplink" target="_blank" rel="noopener noreferrer" href="https://www.google.com/maps/place/Kruger+National+Park">Kruger Safari</a></td><td>Big Five game drives, luxury lodge, all meals</td></tr>
          <tr><td>7‚Äì8</td><td><a class="maplink" target="_blank" rel="noopener noreferrer" href="https://www.google.com/maps/place/Victoria+Falls">Victoria Falls</a></td><td>Guided Falls tour, Zambezi sunset cruise, helicopter optional</td></tr>
          <tr><td>9</td><td>Return</td><td>Fly to Johannesburg, connect to Denver</td></tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- === FLIGHTS & COSTS === -->
  <section id="flights" class="card reveal" data-anim="fade-right" style="--d:.08s" aria-labelledby="flights-title">
    <h2 id="flights-title" class="section-title">Flights & Costs</h2>
    <div class="table-wrap reveal" data-anim="fade-right" style="--d:.16s">
      <table aria-describedby="flights-title">
        <thead><tr><th>Route</th><th>Estimated Cost (USD, Economy)</th></tr></thead>
        <tbody>
          <tr><td>Denver ‚Üí Cape Town</td><td>$1,400</td></tr>
          <tr><td>Victoria Falls ‚Üí Denver (via Johannesburg)</td><td>$1,500</td></tr>
          <tr><td>Cape Town ‚Üí Kruger</td><td>Included in internal flight budget</td></tr>
          <tr><td>Kruger ‚Üí Victoria Falls (via Johannesburg)</td><td>~$700 total internal flights</td></tr>
        </tbody>
      </table>
    </div>
    <p class="muted reveal" data-anim="fade-right" style="--d:.22s"><em>Estimated Mid Level Total: $4,850‚Äì$6,500 per person (incl. flights)</em></p>
  </section>

  <!-- === HIGHLIGHTS === -->
  <section id="highlights" class="card" aria-labelledby="highlights-title">
    <h2 id="highlights-title" class="section-title reveal" data-anim="fade-right">Highlights & Why They‚Äôre Famous</h2>

    <div id="cape-town-highlights" style="scroll-margin-top:80px; margin-bottom:1.2rem">
      <h3 class="reveal" data-anim="fade-right">üáøüá¶ Cape Town</h3>
      <div class="pair-grid">
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.06s">
          <strong>Why it‚Äôs famous</strong>
          <ul class="mini"><li><em>Table Mountain</em> one of the New7Wonders of Nature, framing the city with epic views.</li><li><em>Robben Island</em> Mandela‚Äôs prison; living museum.</li><li><em>Cape Peninsula</em> Cape of Good Hope & Boulders Beach penguins.</li><li><em>Food & Wine</em> world class; easy Winelands access.</li></ul>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.12s">
          <strong>Perfect Day (Mini Itinerary)</strong>
          <ul class="mini"><li>Cable car up Table Mountain.</li><li>Bo Kaap walk & Malay lunch.</li><li>Kirstenbosch or V&A Waterfront.</li><li>Sundowners Signal Hill.</li></ul>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.18s">
          <strong>Top 3 Must Dos</strong>
          <ol class="mini"><li>Sunrise/sunset on Table Mountain or Lion‚Äôs Head.</li><li>Cape Peninsula circuit.</li><li>Robben Island tour.</li></ol>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.24s">
          <strong>Insider Tips</strong>
          <ul class="mini"><li>Book Robben Island early.</li><li>Use Uber/driver for Peninsula day.</li></ul>
        </div></div>
      </div>
    </div>

    <hr style="border:none; border-top:1px solid var(--line); margin:1.2rem 0" />

    <div id="kruger-highlights" style="scroll-margin-top:80px; margin-bottom:1.2rem">
      <h3 class="reveal" data-anim="fade-right">ü¶Å Kruger Safari</h3>
      <div class="pair-grid">
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.06s">
          <strong>Why it‚Äôs famous</strong>
          <ul class="mini"><li><em>Big Five</em> density with reliable sightings.</li><li>Guiding & tracking traditions.</li><li>All-inclusive lodges & stargazing.</li></ul>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.12s">
          <strong>Perfect Day</strong>
          <ul class="mini"><li>Pre-dawn coffee & morning drive.</li><li>Brunch + siesta/pool.</li><li>High tea & evening drive.</li><li>Dinner by the fire.</li></ul>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.18s">
          <strong>Top 3 Must Dos</strong>
          <ol class="mini"><li>Sunrise drive.</li><li>Evening drive + bush dinner.</li><li>Optional bush walk.</li></ol>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.24s">
          <strong>Insider Tips</strong>
          <ul class="mini"><li>June is dry season start ‚Äî pack layers.</li><li>Confirm bush strip timings.</li></ul>
        </div></div>
      </div>
    </div>

    <hr style="border:none; border-top:1px solid var(--line); margin:1.2rem 0" />

    <div id="victoria-falls-highlights" style="scroll-margin-top:80px">
      <h3 class="reveal" data-anim="fade-right">üåä Victoria Falls</h3>
      <div class="pair-grid">
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.06s">
          <strong>Why it‚Äôs famous</strong>
          <ul class="mini"><li>Among the largest by width √ó height.</li><li><em>Mosi oa Tunya</em> ‚Äî Smoke That Thunders.</li><li>Adventure hub: cruises, heli flips, Devil‚Äôs Pool (seasonal).</li></ul>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.12s">
          <strong>Perfect Day</strong>
          <ul class="mini"><li>Morning Falls walk (Zimbabwe side).</li><li>Market/caf√© stop.</li><li>Optional helicopter; hotel relax.</li><li>Zambezi sunset cruise.</li></ul>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.18s">
          <strong>Top 3 Must Dos</strong>
          <ol class="mini"><li>Guided Falls walk + raincoat.</li><li>Zambezi sunset cruise.</li><li>Flight of Angels.</li></ol>
        </div></div>
        <div class="cell"><div class="soft-card reveal" data-anim="fade-right" style="--d:.24s">
          <strong>Insider Tips</strong>
          <ul class="mini"><li>Park fee is per entry ‚Äî plan one focused visit.</li><li>Zim for viewpoints; Zam for Devil‚Äôs Pool.</li></ul>
        </div></div>
      </div>
    </div>
  </section>

  <!-- === FAMILY HUB === -->
  <section id="family-hub" class="card reveal" data-anim="fade-right" aria-labelledby="hub-title">
    <div class="widget-head">
      <h2 id="hub-title" class="section-title">Family Hub - Garcia Gang</h2>
      <div class="row" style="gap:.5rem">
        <div class="pill" id="progressText">Planning Progress: 0%</div>
      </div>
    </div>

    <div class="widgets">
      <div class="w" id="rsvpCard">
        <div class="soft-card">
          <div class="widget-head">
            <h3>RSVP & Roles</h3>
            <div class="row" style="flex:0 0 auto">
              <button class="btn" id="seedPeople">Reset</button>
              <button class="btn" id="addPersonBtn">Ôºã Add Person</button>
            </div>
          </div>
          <div class="list" id="peopleList" aria-live="polite"></div>
        </div>
      </div>

      <div class="w" id="tasksCard">
        <div class="soft-card">
          <div class="widget-head">
            <h3>Task Board</h3>
            <div class="row add-task" style="flex:0 0 auto">
  <input id="taskInput" class="input" placeholder="Add a task" />
  <button class="btn" id="addTaskBtn">Add</button>
  <button class="btn" id="seedTasks">Reset</button>
</div>

          </div>
          <div class="list" id="taskList"></div>
          <div class="progress" style="margin-top:.6rem"><span id="taskProgress"></span></div>
        </div>
      </div>
    </div>
  </section>

  <!-- === PACKING === -->
  <section id="packing" class="card reveal" data-anim="fade-right" aria-labelledby="pack-title">
    <h2 id="pack-title" class="section-title">Packing Checklist</h2>
    <div class="widgets">
      <div class="w"><div class="soft-card"><div class="widget-head"><h3>Essentials</h3></div><div class="checklist" id="packEssentials"></div></div></div>
      <div class="w"><div class="soft-card"><div class="widget-head"><h3>Safari</h3></div><div class="checklist" id="packSafari"></div></div></div>
      <div class="w"><div class="soft-card"><div class="widget-head"><h3>Falls & Water</h3></div><div class="checklist" id="packFalls"></div></div></div>
      <div class="w"><div class="soft-card"><div class="widget-head"><h3>Med/Docs</h3></div><div class="checklist" id="packDocs"></div></div></div>
    </div>
  </section>

  <!-- === BUDGET === -->
  <section id="budget" class="card reveal" data-anim="fade-right" aria-labelledby="budget-title">
    <div class="widget-head">
      <h2 id="budget-title" class="section-title">Budget Planner</h2>
      <div class="row" style="max-width:720px">
        <input id="budgetItem" class="input" placeholder="Item e.g., Robben Island tickets" />
        <input id="budgetAmt" class="input" type="number" min="0" step="0.01" placeholder="Amount USD" />
        <button class="btn" id="addBudget">Add</button>
      </div>
    </div>
    <div class="table-wrap">
      <table aria-label="Budget table">
        <thead><tr><th>Item</th><th style="width:160px">Amount</th><th style="width:120px">Actions</th></tr></thead>
        <tbody id="budgetBody"></tbody>
        <tfoot><tr><th>Total</th><th id="budgetTotal">$0.00</th><th></th></tr></tfoot>
      </table>
    </div>
  </section>

  <!-- === HEALTH & VISAS === -->
  <section id="health" class="card reveal" data-anim="fade-right" aria-labelledby="health-title">
    <h2 id="health-title" class="section-title">Health & Entry Info U.S. Citizens</h2>
    <div class="widgets">
      <div class="w wide">
        <div class="soft-card">
          <div class="widget-head"><h3>Vaccines & Health</h3></div>
          <ul class="mini">
            <li><strong>Yellow fever:</strong> <em>Not required</em> when arriving from the U.S. or South Africa. Required only if you arrive from a yellow fever risk country.</li>
            <li><strong>Malaria:</strong> Recommended prophylaxis for <em>Kruger</em> and <em>Victoria Falls</em>.</li>
            <li><strong>Other shots:</strong> Hep A and Typhoid are commonly advised. Keep routine vaccines current.</li>
            <li><strong>Water & food:</strong> Prefer bottled or treated water. Pack oral rehydration and basic meds.</li>
          </ul>
        </div>
      </div>

      <div class="visa-row">
        <div class="soft-card">
          <div class="widget-head"><h3>Visas South Africa</h3></div>
          <ul class="mini">
            <li>U.S. citizens: visa exempt up to 90 days for tourism.</li>
            <li>Passport validity: at least 30 days beyond departure, with 2 blank pages.</li>
          </ul>
        </div>
        <div class="soft-card">
          <div class="widget-head"><h3>Visas Zimbabwe &amp; Zambia</h3></div>
          <ul class="mini">
            <li>Zimbabwe: visa on arrival available in most cases.</li>
            <li>Zambia: if crossing, consider KAZA Univisa ~ $50 covering both for 30 days.</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- === GALLERY === -->
  <section id="gallery" class="card reveal" data-anim="fade-right" aria-labelledby="gallery-title">
    <div class="widget-head"><h2 id="gallery-title" class="section-title">Inspiration Gallery</h2><div class="muted">Tap any image to view larger</div></div>
    <div class="gallery" id="galleryGrid">
      <img src="images/cape-town-africa.jpg" alt="Cape Town" />
      <img src="images/kruger-big5.jpg" alt="Kruger" />
      <img src="images/victoria-falls.jpg" alt="Victoria Falls" />
      <img src="images/bo-kaap.jpg" alt="Bo Kaap" />
      <img src="images/penguins.jpg" alt="Boulders Beach Penguins" />
      <img src="images/zambezi-sunset.jpg" alt="Zambezi Sunset" />
    </div>
    <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-label="Image viewer">
      <img id="lightboxImg" alt="" />
    </div>
  </section>
</main>

<button class="to-top btn" aria-label="Back to top" style="position:fixed; right:12px; bottom:12px; display:none">‚ñ≤ Top</button>

<script>
  // ===== Utilities =====
  const store = {
    get: (k, fallback) => { try { return JSON.parse(localStorage.getItem(k)) ?? fallback } catch { return fallback } },
    set: (k, v) => localStorage.setItem(k, JSON.stringify(v)),
    del: (k) => localStorage.removeItem(k)
  };
  const K = { theme:'garcia.theme', people:'garcia.people', tasks:'garcia.tasks', budget:'garcia.budget', packing:'garcia.packing' };

  // Flags for progress
  const FLAGS = 'garcia.flags';
  let flags = store.get(FLAGS, { rsvp:false, tasks:false, pack:false, budget:false, date:false });
  function saveFlags(){ store.set(FLAGS, flags); }

  // Smooth scroll + active link
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', e=>{
      const href=a.getAttribute('href');
      if(href.length>1){ e.preventDefault(); const target=document.querySelector(href); if(target) target.scrollIntoView({behavior:'smooth'}); }
    });
  });
  const sections=[...document.querySelectorAll('main section')];
  const navLinks=[...document.querySelectorAll('.nav a')];
  function onScroll(){
    const y=window.scrollY+90; let id=null;
    sections.forEach(s=>{ const r=s.getBoundingClientRect(); const top=window.scrollY+r.top; if(y>=top && y<top+r.height) id=s.id; });
    navLinks.forEach(l=> l.classList.toggle('active', l.getAttribute('href')==='#'+id));
  }
  document.addEventListener('scroll', onScroll, {passive:true}); onScroll();

  // Back-to-top
  const toTop=document.querySelector('.to-top');
  function toggleTop(){ toTop.style.display = window.scrollY>500 ? 'block' : 'none'; }
  document.addEventListener('scroll', toggleTop, {passive:true});
  toTop.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));

  // ===== HERO CAROUSEL =====
  (function(){
    const slides=[...document.querySelectorAll('.slide')];
    const dots=[...document.querySelectorAll('.dot')];
    if(!slides.length) return;
    let i=0, timer=null;
    function setActive(n){
      slides.forEach((s,idx)=>s.classList.toggle('active', idx===n));
      dots.forEach((d,idx)=>{ d.classList.toggle('active', idx===n); d.setAttribute('aria-selected', idx===n ? 'true' : 'false'); });
      i=n;
    }
    function next(){ setActive((i+1)%slides.length); }
    function start(){ timer=setInterval(next, 5200); }
    function stop(){ if(timer) clearInterval(timer); }
    dots.forEach((d,idx)=> d.addEventListener('click', ()=>{ stop(); setActive(idx); start(); }));
    const hero=document.querySelector('.hero');
    hero.addEventListener('mouseenter', stop); hero.addEventListener('mouseleave', start);
    start();
  })();

  // Scroll reveal
  (function(){
    const items=[...document.querySelectorAll('.reveal')];
    if(!('IntersectionObserver' in window)||!items.length) { items.forEach(el=>el.classList.add('show')); return; }
    const io=new IntersectionObserver((entries,obs)=>{
      entries.forEach(entry=>{ if(entry.isIntersecting){ entry.target.classList.add('show'); obs.unobserve(entry.target);} });
    }, {root:null, rootMargin:'0px 0px -10% 0px', threshold:0.12});
    items.forEach(el=> io.observe(el));
  })();

  // Theme, share, print
  const themeToggle=document.getElementById('themeToggle');
  const shareBtn=document.getElementById('shareBtn');
  const printBtn=document.getElementById('printBtn');
  function applyTheme(t){ document.documentElement.setAttribute('data-theme', t); themeToggle?.setAttribute('aria-pressed', t==='dark'); store.set(K.theme, t); }
  applyTheme(store.get(K.theme,'light'));
  themeToggle?.addEventListener('click', ()=>{ const t=document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark'; applyTheme(t); });
  shareBtn?.addEventListener('click', async ()=>{
    const data={ title:document.title, text:'Garcia Gang trip dossier', url:location.href };
    try{ if(navigator.share){ await navigator.share(data); } else { await navigator.clipboard.writeText(location.href); alert('Link copied to clipboard!'); } }catch(e){ console.warn(e); }
  });
  printBtn?.addEventListener('click', ()=> window.print());

  // ===== Countdown =====
  const cdRoot = document.getElementById('countdown');
  const startISO = cdRoot?.dataset.start || '2027-06-01T00:00:00-06:00';
  if (cdRoot){
    const START = new Date(startISO);
    const unitDefs = [
      {k:'days',    labelWide:'Days',    labelNarrow:'Days'},
      {k:'hours',   labelWide:'Hours',   labelNarrow:'Hours'},
      {k:'minutes', labelWide:'Minutes', labelNarrow:'Min'},
      {k:'seconds', labelWide:'Seconds', labelNarrow:'Sec'}
    ];
    const cdNodes = {};
    unitDefs.forEach(u=>{
      const card = document.createElement('div'); card.className='cd-card'; card.dataset.unit=u.k;
      const val  = document.createElement('span'); val.className='cd-val'; val.textContent='--';
      const lab  = document.createElement('span'); lab.className='cd-label'; lab.textContent=u.labelWide;
      card.append(val, lab); cdRoot.appendChild(card);
      cdNodes[u.k] = { val, lab, def: u };
    });
    function setLabels(){
      const narrow = window.matchMedia('(max-width: 420px)').matches;
      Object.values(cdNodes).forEach(n=>{ n.lab.textContent = narrow ? n.def.labelNarrow : n.def.labelWide; });
    }
    setLabels(); window.addEventListener('resize', setLabels);
    const pad2 = n => String(n).padStart(2,'0');
    function setVal(k, next){
      const el = cdNodes[k].val;
      if(el.textContent !== next){
        el.textContent = next;
        el.classList.remove('cd-bump'); void el.offsetWidth; el.classList.add('cd-bump');
      }
    }
    function render(){
      const now = new Date();
      let ms = Math.max(0, START - now);
      const s = Math.floor(ms/1000);
      const d = Math.floor(s/86400);
      const h = Math.floor((s%86400)/3600);
      const m = Math.floor((s%3600)/60);
      const sec = s%60;
      setVal('days', String(d).padStart(3,'0'));
      setVal('hours', pad2(h));
      setVal('minutes', pad2(m));
      setVal('seconds', pad2(sec));
    }
    let last = 0;
    function loop(ts){ if(ts - last > 250){ render(); last = ts; } requestAnimationFrame(loop); }
    requestAnimationFrame(loop);
  }

  // ===== RSVP =====
  const peopleList = document.getElementById('peopleList');
  const addPersonBtn = document.getElementById('addPersonBtn');
  const seedPeopleBtn = document.getElementById('seedPeople');
  const APP_VERSION = 3;
  const VERSION_KEY = 'garcia.version';
  const DEFAULT_PEOPLE = [
    {name:'Primrose',     status:'ü§© In', role:'üß≠ Trip Captain'},
    {name:'Shae',         status:'üëç In', role:'Showing up :)'},
    {name:'Tracy',        status:'üç∏ In', role:'Food & Vibes'},
    {name:'LeRoy',        status:'üëç In', role:'Food & Vibes'},
    {name:'Ash',          status:'ü§î Maybe', role:'Wakanda :)'},
    {name:'Miss Ellison', status:'ü§î Maybe', role:'Food & Vibes'}
  ];
  let people = store.get(K.people, DEFAULT_PEOPLE);
  function migratePeople(force=false){
    const current = store.get(VERSION_KEY, 0);
    if (!force && current >= APP_VERSION) return;
    const byName = new Map(people.map(p => [String(p.name||'').toLowerCase(), p]));
    let changed = false;
    DEFAULT_PEOPLE.forEach(p=>{ const key = String(p.name).toLowerCase(); if(!byName.has(key)){ people.push({...p}); changed = true; }});
    people = people.map(p => {
      const role = String(p.role||'').trim();
      const isCaptain = /(^|\s)trip\s*captain$/i.test(role.replace(/^([\p{Extended_Pictographic}])+(\s)*/u,'')); 
      return isCaptain && !role.includes('üß≠') ? {...p, role:'üß≠ Trip Captain'} : p;
    });
    if (changed || force){ store.set(K.people, people); }
    store.set(VERSION_KEY, APP_VERSION);
  }
  migratePeople(false);
  function renderPeople(){
    if(!peopleList) return;
    peopleList.innerHTML = '';
    people.forEach((p, idx) => {
      const row = document.createElement('div');
      row.className = 'soft-card';
      const isCaptain = /trip\s*captain/i.test(String(p.role||''));
      const roleDisplay = isCaptain ? 'üß≠ Trip Captain' : (p.role || '');
      row.innerHTML = `
        <div class="row">
          <input class="input" value="${p.name}" aria-label="name" />
          <select class="input" aria-label="status">
            <option ${p.status==='ü§© In'?'selected':''}>ü§© In</option>
            <option ${p.status==='üç∏ In'?'selected':''}>üç∏ In</option>
            <option ${p.status==='üëç In'?'selected':''}>üëç In</option>
            <option ${p.status==='ü§î Maybe'?'selected':''}>ü§î Maybe</option>
            <option ${p.status==='‚ùå Out'?'selected':''}>‚ùå Out</option>
          </select>
        </div>
        <div class="row">
          <input class="input" value="${roleDisplay}" placeholder="Role e.g., Flights" aria-label="role" />
          <button class="btn" aria-label="Delete" data-del>üóëÔ∏è</button>
        </div>`;
      row.querySelector('[data-del]').addEventListener('click', () => {
        people.splice(idx, 1); savePeople(); flags.rsvp = true; saveFlags(); renderPeople(); updateProgress();
      });
      row.querySelectorAll('input,select').forEach((el) =>
        el.addEventListener('input', () => {
          const [nameEl, statusEl] = row.querySelectorAll('.row:first-child input, .row:first-child select');
          const roleEl = row.querySelector('.row:last-child input');
          let roleVal = roleEl.value.trim();
          const plain = roleVal.replace(/^([\p{Extended_Pictographic}])+(\s)*/u,'').trim();
          if (/^trip\s*captain$/i.test(plain)) roleVal = 'üß≠ Trip Captain';
          people[idx] = { name: nameEl.value.trim(), status: statusEl.value, role: roleVal };
          savePeople(); flags.rsvp = true; saveFlags(); updateProgress();
        })
      );
      peopleList.appendChild(row);
    });
  }
  function savePeople(){ store.set(K.people, people); }
  addPersonBtn?.addEventListener('click', () => { people.push({name:'', status:'ü§î Maybe', role:''}); savePeople(); flags.rsvp = true; saveFlags(); renderPeople(); updateProgress(); });
  seedPeopleBtn?.addEventListener('click', ()=>{ people = JSON.parse(JSON.stringify(DEFAULT_PEOPLE)); savePeople(); store.set(VERSION_KEY, APP_VERSION); flags.rsvp = true; saveFlags(); renderPeople(); updateProgress(); });
  renderPeople();

  // ===== TASKS =====
  const taskInput = document.getElementById('taskInput');
  const addTaskBtn = document.getElementById('addTaskBtn');
  const taskList = document.getElementById('taskList');
  const taskProgress = document.getElementById('taskProgress');
  const seedTasksBtn = document.getElementById('seedTasks');
  const TASKS_VERSION_KEY = 'garcia.tasks.version';
  const TASKS_VERSION = 2;
  const DEFAULT_TASKS = [
    {text:'Confirm number of people going', done:false},
    {text:'Book flights', done:false},
    {text:'Book vacation package', done:false},
    {text:'Confirm Cape Town excursions', done:false},
    {text:'Confirm Zambezi cruise', done:false}
  ];
  let tasks = store.get(K.tasks, DEFAULT_TASKS);
  function migrateTasks(force=false){
    const current = store.get(TASKS_VERSION_KEY, 0);
    if (!force && current >= TASKS_VERSION) return;
    const wanted = DEFAULT_TASKS.map(t => t.text.toLowerCase());
    const doneMap = new Map((Array.isArray(tasks) ? tasks : []).map(t => [String(t.text || '').toLowerCase(), !!t.done]));
    const nextDefaults = DEFAULT_TASKS.map(t => ({ text: t.text, done: doneMap.get(t.text.toLowerCase()) || false }));
    const extras = (Array.isArray(tasks) ? tasks : []).filter(t => !wanted.includes(String(t.text || '').toLowerCase()));
    tasks = [...nextDefaults, ...extras];
    store.set(K.tasks, tasks); store.set(TASKS_VERSION_KEY, TASKS_VERSION);
  }
  migrateTasks(false);
  function renderTasks(){
    if(!taskList) return;
    taskList.innerHTML = '';
    tasks.forEach((t, idx) => {
      const el = document.createElement('div');
      el.className = 'soft-card';
      el.innerHTML = `
        <div class="row">
          <input type="checkbox" ${t.done ? 'checked' : ''} aria-label="toggle task" style="flex:0 0 auto; width:20px; height:20px">
          <input class="input" value="${t.text}" aria-label="task text">
          <button class="btn" aria-label="Delete">üóëÔ∏è</button>
        </div>`;
      const cb = el.querySelector('input[type="checkbox"]');
      const txt = el.querySelector('.input');
      const del = el.querySelector('button');
      cb.addEventListener('change', () => { tasks[idx].done = cb.checked; saveTasks(); flags.tasks = true; saveFlags(); updateTaskProgress(); updateProgress(); });
      txt.addEventListener('input', () => { tasks[idx].text = txt.value; saveTasks(); flags.tasks = true; saveFlags(); updateProgress(); });
      del.addEventListener('click', () => { tasks.splice(idx, 1); saveTasks(); flags.tasks = true; saveFlags(); renderTasks(); updateTaskProgress(); updateProgress(); });
      taskList.appendChild(el);
    });
    updateTaskProgress();
  }
  function saveTasks(){ store.set(K.tasks, tasks); }
  function updateTaskProgress(){ const total = tasks.length || 1; const done = tasks.filter(t => t.done).length; const pct = Math.round(done / total * 100); taskProgress && (taskProgress.style.width = pct + '%'); }
  addTaskBtn?.addEventListener('click', () => { if (taskInput.value.trim()){ tasks.unshift({text: taskInput.value.trim(), done:false}); taskInput.value = ''; saveTasks(); flags.tasks = true; saveFlags(); renderTasks(); updateTaskProgress(); updateProgress(); }});
  seedTasksBtn?.addEventListener('click', ()=>{ tasks = JSON.parse(JSON.stringify(DEFAULT_TASKS)); saveTasks(); store.set(TASKS_VERSION_KEY, TASKS_VERSION); flags.tasks = true; saveFlags(); renderTasks(); updateTaskProgress(); updateProgress(); });
  renderTasks();

  // ===== PACKING =====
  const checklistData={
    packEssentials:['Passport + visas','Credit cards / USD cash','Travel insurance','Universal adapter','Phone + charger','Sunscreen SPF 30+','Sunglasses','Comfortable shoes'],
    packSafari:['Neutral layers khaki or olive','Light down jacket','Wide brim hat','Binoculars','Camera + batteries','Insect repellent','Small torch or headlamp'],
    packFalls:['Light rain jacket','Quick dry clothes','Waterproof pouch','Sandals or water shoes','Spare SD cards'],
    packDocs:['Malaria meds','Prescription meds','Copies of docs','Emergency contacts','Lodge confirmations']
  };
  const packingState=store.get(K.packing, {});
  function renderChecklist(id, items){
    const box=document.getElementById(id);
    if(!box) return;
    box.innerHTML='';
    items.forEach((label, i)=>{
      const key=id+':'+i;
      const wrap=document.createElement('label'); wrap.className='check';
      wrap.innerHTML=`<input type="checkbox" ${packingState[key]?'checked':''}><span>${label}</span>`;
      const cb=wrap.querySelector('input');
      cb.addEventListener('change',()=>{ packingState[key]=cb.checked; store.set(K.packing, packingState); flags.pack = true; saveFlags(); updateProgress(); });
      box.appendChild(wrap);
    });
  }
  renderChecklist('packEssentials', checklistData.packEssentials);
  renderChecklist('packSafari', checklistData.packSafari);
  renderChecklist('packFalls', checklistData.packFalls);
  renderChecklist('packDocs', checklistData.packDocs);

  // ===== BUDGET =====
  const budgetBody=document.getElementById('budgetBody');
  const budgetTotal=document.getElementById('budgetTotal');
  const addBudget=document.getElementById('addBudget');
  const budgetItem=document.getElementById('budgetItem');
  const budgetAmt=document.getElementById('budgetAmt');
  let budget=store.get(K.budget, [
    {item:'Flights per person est.', amount:4850},
    {item:'Robben Island tickets 2', amount:60},
    {item:'Zambezi sunset cruise 2', amount:120}
  ]);
  function renderBudget(){
    if(!budgetBody) return;
    budgetBody.innerHTML='';
    budget.forEach((b,idx)=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`<td><input class="input" value="${b.item}"></td><td><input class="input" type="number" min="0" step="0.01" value="${b.amount}"></td><td><button class="btn" aria-label="Delete">üóëÔ∏è</button></td>`;
      const [itemEl, amtEl, del]=tr.querySelectorAll('input,button');
      const sync=()=>{ budget[idx].item=itemEl.value; budget[idx].amount=parseFloat(amtEl.value||0); saveBudget(); flags.budget = true; saveFlags(); updateBudgetTotal(); updateProgress(); };
      itemEl.addEventListener('input', sync); amtEl.addEventListener('input', sync);
      del.addEventListener('click', ()=>{ budget.splice(idx,1); saveBudget(); flags.budget = true; saveFlags(); renderBudget(); updateBudgetTotal(); updateProgress(); });
      budgetBody.appendChild(tr);
    });
    updateBudgetTotal();
  }
  function saveBudget(){ store.set(K.budget, budget); }
  function updateBudgetTotal(){ const total=budget.reduce((s,b)=> s + (parseFloat(b.amount)||0),0); budgetTotal && (budgetTotal.textContent = new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'}).format(total)); }
  addBudget?.addEventListener('click', ()=>{ const item=budgetItem.value.trim(); const amt=parseFloat(budgetAmt.value); if(!item||isNaN(amt)) return; budget.push({item, amount:amt}); budgetItem.value=''; budgetAmt.value=''; saveBudget(); flags.budget = true; saveFlags(); renderBudget(); updateBudgetTotal(); updateProgress(); });
  renderBudget();

  // ===== LIGHTBOX =====
  const gallery=document.getElementById('galleryGrid');
  const lightbox=document.getElementById('lightbox');
  const lightboxImg=document.getElementById('lightboxImg');
  gallery?.addEventListener('click', (e)=>{ const img=e.target.closest('img'); if(!img) return; lightboxImg.src=img.src; lightboxImg.alt=img.alt; lightbox.classList.add('show'); });
  lightbox?.addEventListener('click', ()=> lightbox.classList.remove('show'));
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') lightbox?.classList.remove('show'); });

  // ===== PROGRESS =====
  const progressText=document.getElementById('progressText');
  function updateProgress(){
    const haveDate   = true;
    const rsvpDone   = (store.get(K.people, [])).some(p => p.status?.includes('In'));
    const tasksNow   = store.get(K.tasks, []);
    const tasksTotal = tasksNow.length;
    const tasksDone  = tasksNow.filter(t => t.done).length;
    const taskPct    = tasksTotal ? (tasksDone / tasksTotal) : 0;
    const packState  = store.get(K.packing, {});
    const packPct    = (Object.values(packState).filter(Boolean).length) / (Object.keys(packState).length || 1);
    const budgetHas  = (store.get(K.budget, [])).length > 0;

    const parts = [];
    if (flags.date)   parts.push({ w:0.20, v: haveDate ? 1 : 0 });
    if (flags.rsvp)   parts.push({ w:0.20, v: rsvpDone ? 1 : 0 });
    if (flags.tasks)  parts.push({ w:0.30, v: taskPct });
    if (flags.pack)   parts.push({ w:0.15, v: packPct });
    if (flags.budget) parts.push({ w:0.15, v: budgetHas ? 1 : 0 });

    if (!parts.length){ progressText && (progressText.textContent = 'Planning Progress: 0%'); return; }
    const wSum = parts.reduce((s,p)=> s + p.w, 0) || 1;
    const score = Math.round(100 * parts.reduce((s,p)=> s + p.w * p.v, 0) / wSum);
    progressText && (progressText.textContent = `Planning Progress: ${score}%`);
  }
  window.resetAllTripData = function(){
    [K.people,K.tasks,K.budget,K.packing,FLAGS,'garcia.version','garcia.tasks.version'].forEach(store.del);
    location.reload();
  };
  updateProgress();
</script>
</body>
</html>
